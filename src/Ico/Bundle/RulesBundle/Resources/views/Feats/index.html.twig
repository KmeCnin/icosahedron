{% extends "IcoRulesBundle::layout.html.twig" %}

{% block content %}
<div class="well bs-component">
    <form class="form content" role="form">
	   <fieldset class="row">
		  <legend class="col-xs-12">Recherche</legend>
		  <div class="form-group col-xs-2">
			 <label class="control-label" for="name">Don</label>
			 <input class="form-control" id="name" type="text" placeholder="Chercher par mot-clé" autocomplete="off" />
		  </div>
		  <div class="form-group col-xs-4">
			 <label class="control-label" for="types">Catégories</label>
			 <select class="form-control" id="types" type="select" multiple data-placeholder="Choisissez plusieurs">
				{% for type in feattypes %}
				<option value="{{ type.id }}">{{ type.name }}</option>
				{% endfor %}
			 </select>
		  </div>
		  <div class="form-group col-xs-4">
			 <label class="control-label" for="prerequisistes">Prérequis</label>
			 <select class="form-control" id="prerequisistes" type="select" multiple data-placeholder="Choisissez plusieurs">
				{% for prerequisite in featprerequisites %}
				<option value="{{ prerequisite.id }}">{{ prerequisite.name }}</option>
				{% endfor %}
			 </select>
		  </div>
		  <div class="form-group col-xs-2">
			 <label class="control-label" for="description">Description</label>
			 <input class="form-control" id="description" type="text" placeholder="Chercher par mot-clé" autocomplete="off" />
		  </div>
	   </fieldset>
    </form>
</div>
<table class="table table-striped table-hover">
    <tr>
	   <th{% if pagination.isSorted('feat.Name') %} class="sorted"{% endif %}>{{ knp_pagination_sortable(pagination, 'Don', 'feat.name') }}</th>
	   <th>Catégories</th>
	   <th>Prérequis</th>
	   <th>Description</th>
    </tr>
	   {% for feat in pagination %}
    <tr>
	   <td class="link" data-toggle="modal" data-target="#modal_feat_{{ feat.id }}"><a>{{ feat.name }}</a></td>
	   <td>
		  {% for feattype in feat.feattypes %}{% if loop.index != 1 %}, {% endif %}{% if feattype.description is not empty %}<a class="preview text-nowrap" href="{{ path('ico_rules_feattypes_view', {'id': feattype.id}) }}">{{ feattype.name }}</a>{% else %}{{ feattype.name }}{% endif %}{% endfor %}
	   </td>
	   <td>
		  {% for featprerequisite in feat.featprerequisites %}{% if loop.index != 1 %}, {% endif %}{% if featprerequisite.link != '' %}<a class="preview text-nowrap" href="{{ featprerequisite.link }}">{{ featprerequisite.name }}</a>{% else %}<span class="text-nowrap">{{ featprerequisite.name }}</span>{% endif %}{% endfor %}
	   </td>
	   <td>{{ feat.description }}</td>
    </tr>
	   {% endfor %}
	   {# Modales #}
	   {% for feat in pagination %}
    <div class="modal fade" id="modal_feat_{{ feat.id }}" tabindex="-1" role="dialog" aria-labelledby="modal_feat_{{ feat.id }}" aria-hidden="true">
	   <div class="modal-dialog modal-lg">
		  <div class="modal-content">
			 <div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Fermer</span></button>
				<h4 class="modal-title" id="myModalLabel">{{ feat.name }} <small>[Don]</small></h4>
			 </div>
			 <div class="modal-body">
				<div class="panel panel-default">
				    <div class="panel-heading">Catégories</div>
				    <div class="panel-body">
				    {% for feattype in feat.feattypes %}{% if loop.index != 1 %}, {% endif %}{% if feattype.description is not empty %}<a class="preview text-nowrap" href="{{ path('ico_rules_feattypes_view', {'id': feattype.id}) }}">{{ feattype.name }}</a>{% else %}{{ feattype.name }}{% endif %}{% endfor %}
				    </div>
				</div>
				<div class="panel panel-default">
				    <div class="panel-heading">Conditions</div>
				    <div class="panel-body">
				    {% for featprerequisite in feat.featprerequisites %}{% if loop.index != 1 %}, {% endif %}{% if featprerequisite.link != '' %}<a class="preview text-nowrap" href="{{ featprerequisite.link }}">{{ featprerequisite.name }}</a>{% else %}<span class="text-nowrap">{{ featprerequisite.name }}</span>{% endif %}{% endfor %}
				    </div>
				</div>
				<div class="panel panel-default">
				    <div class="panel-heading">Avantage</div>
				    <div class="panel-body justify">{{ feat.benefit }}</div>
				</div>
			 </div>
			 <div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
			 </div>
		  </div>
	   </div>
    </div>
	   {% endfor %}
</table>
{# display navigation #}
<div class="navigation" style="text-align: center;">
{{ knp_pagination_render(pagination) }}
</div>
{% endblock %}